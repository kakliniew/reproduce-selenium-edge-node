apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: selenium-grid
  namespace: argocd
spec:
  project: default
  source:
    repoURL: https://github.com/kakliniew/reproduce-selenium-edge-node
    path: selenium-grid
    targetRevision: master
    helm:
      parameters:
        - name: global.seleniumGrid.logLevel
          value: "DEBUG"
        - name: basicAuth.enabled
          value: "false"
        - name: hub.replicaCount
          value: "1"
        - name: tracing.enabled
          value: "true"
        - name: edgeNode.enabled
          value: "true"
        - name: firefoxNode.enabled
          value: "false"
        - name: chromeNode.enabled
          value: "false"
        - name: hub.image.tag
          value: "4.15.0"
        - name: global.seleniumGrid.nodesImageTag
          value: "4.15.0"
        - name: hub.extraEnvironmentVariables[0].name
          value: "SE_JAVA_OPTS"
        - name: hub.extraEnvironmentVariables[0].value
          value: "-XX:+UnlockExperimentalVMOptions -XX:+UseZGC"
        - name: edgeNode.extraEnvironmentVariables[0].name
          value: "SE_JAVA_OPTS"
        - name: edgeNode.extraEnvironmentVariables[0].value
          value: "-XX:+UnlockExperimentalVMOptions -XX:+UseZGC"
        - name: chromeNode.extraEnvironmentVariables[0].name
          value: "SE_JAVA_OPTS"
        - name: chromeNode.extraEnvironmentVariables[0].value
          value: "-XX:+UnlockExperimentalVMOptions -XX:+UseZGC"
        - name: firefoxNode.extraEnvironmentVariables[0].name
          value: "SE_JAVA_OPTS"
        - name: firefoxNode.extraEnvironmentVariables[0].value
          value: "-XX:+UnlockExperimentalVMOptions -XX:+UseZGC"
  destination:
    server: https://kubernetes.default.svc
    namespace: selenium-grid
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
